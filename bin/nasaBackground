#!/bin/sh
SETBG='feh --bg-fill'
if [ "${XDG_SESSION_TYPE:-}" = wayland ]; then
	SETBG='swaybg -m fill -o "*" -i '
fi

set -e
set -x
curl -o /tmp/wallpaper -H 'Accept: image/png' -m 30 -sS -L \
	'https://unsplash.it/'"$(getscreensize | tr x /)"'/?random'
set +e
if ! [ "${XDG_SESSION_TYPE:-}" = wayland ]; then
	feh --bg-fill /tmp/wallpaper
	exit 0
fi
pkill swaybg
swaybg -m fill -i /tmp/wallpaper &
disown
